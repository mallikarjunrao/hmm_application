
<script type="text/javascript">
  function passwordStrength(v_password)
  {
    var desc = new Array();
    desc[0] = "Very Weak";
    desc[1] = "Weak";
    desc[2] = "Better";
    desc[3] = "Medium";
    desc[4] = "Strong";
    desc[5] = "Strongest";
    var score = 0; //if password bigger than 6 give 1 point
    if (v_password.length > 6) score++; //if password has both lower and uppercase characters give 1 point
    if ( ( v_password.match(/[a-z]/) ) && ( v_password.match(/[A-Z]/) ) ) score++; //if password has at least one number give 1 point
    if (v_password.match(/\d+/)) score++; //if password has at least one special caracther give 1 point
    if ( v_password.match(/.[!,@,#,$,%,^,&,*,?,_,~,-,(,)]/) ) score++; //if password bigger than 12 give another 1 point
    if (v_password.length > 12) score++; document.getElementById("passwordDescription").innerHTML = desc[score];
    document.getElementById("passwordStrength").className = "strength" + score;
  } 
</script>

<%= javascript_include_tag 'SpryAssets/SpryValidationPassword' %>
<%= javascript_include_tag 'SpryAssets/SpryValidationConfirm' %>

<%= stylesheet_link_tag 'SpryAssets/SpryValidationPassword' %>
<%= stylesheet_link_tag 'SpryAssets/SpryValidationConfirm' %>
<style type="text/css">
  <!--
  .style9 {color: #CCCCCC}
  .style11 {color: #CCCCCC; font-size: 14px; }
  -->
</style>


<table width="100%" cellpadding="0" cellspacing="0"  valign="top" align="left" border="0">
  <tr>
    <td width="170"  valign="top" align="left">
      <%= render :partial => "manage_site/leftnav", :locals => { :current => "passwords"} %>
    </td>
    <td width="680">

      <form name="frm" action="/mysite_security/chg_password_execute/" method="post">
        <table width="100%" height=402  align=center border=0>

          <tr>
            <th><center></center></th></tr>
          <tr bordercolor="#000000"><td valign="top"><br><br><br>
              <table width="100%" border="2" align="center" valign="middle"  cellpadding="5" cellspacing="5" bordercolor="#191919">


                <input type="hidden" name="familyname" value="<%=params[:id]%>" />
                <tr >
                  <td colspan="2" align="center" valign="middle" style="border:none" bgcolor="#191919" height="20">
                    <span class="style9"><font size="3px">Change Password</font></span></td>
                </tr>

                <p align="center" width="100%"><font color="#ee0000"><%=flash[:notice]%></font></p>

                <tr>
                  <td align="left" style="border:none"><div align="right"><span class="style11">Current Password </span></div></td>
                  <td style="border:none" align="left">
                  <%= password_field 'pass', 'old', :size => 20, :class => "textbox-signup-managepage" %>      </td>
                </tr >

                <tr style="border:none"><td align="left" style="border:none"><div align="right"><font size="3" class="style11">Type New Password</font></div></td>
                  <td align="left" style="border:none">
                    <span class="" id="sprypassword12">
                      <%= password_field 'pass', 'new', :size => 20, :class => "textbox-signup-managepage", :onkeyup => "passwordStrength(this.value)" %>
                      <span class="passwordRequiredMsg">A value is required.</span> <span class="passwordMinCharsMsg">The minimum number of characters not met.</span> </span>	 </td>
                </tr >

                <tr class="style11">
                  <td align="right" class="border">Password Strength</td>
                  <td height="14" class="border">
                    <div id="passwordStrength" class="style11"></div>
                    <div id="passwordDescription"></div>		</td>
                </tr>

                <tr style="border:none"><td align="left" valign="top" style="border:none"><div align="right"><font size="3" class="style11">Re-Type New Password</font></div></td>
                  <td align="left" style="border:none">
                    <span class="" id="spryconfirm2">
                      <%= password_field 'pass', 'confirm', :size => 20, :class => "textbox-signup-managepage" %>
                      <span class="confirmRequiredMsg"><br>A value is required.</span> <span class="confirmInvalidMsg">The values don't match</span> </span></span>     </td>
                </tr >

                <tr style="border:none"><td style="border:none"></td><td  style="border:none" colspan="" align="left">
                    <input type="image" name="sub" id="sign_in" src="/images/change-password.jpg"  border="0" /></td></tr>
                <tr style="border:none">
                <tr bordercolor="#191919"><td  colspan="2" align="center" style="border:none"></td>
                </tr>
                <tr style="border:none"><td colspan="2" align="center" style="border:none"><p>
                      <font face="Arial" color="#ffffff" size=2 >


                  </td></tr>
              </table>
            </td></tr>
        </table>

      </form>
    </td>
  </tr>
</table>
<script type="text/javascript">
  var spryconf1 = new Spry.Widget.ValidationConfirm("spryconfirm2", "sprypassword12", {validateOn: ['blur']});
</script>