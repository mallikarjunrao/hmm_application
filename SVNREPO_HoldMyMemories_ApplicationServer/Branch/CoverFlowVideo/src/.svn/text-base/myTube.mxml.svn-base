<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:local="*" 
   backgroundColor="black" applicationComplete="handleApplicationComplete()">
  
  <mx:HTTPService id="service" result="handleResult(event)" fault="handleFault(event)"/>
	<mx:Script>
		<![CDATA[
			import mx.collections.ArrayCollection;
			import mx.rpc.events.ResultEvent;
			import mx.rpc.events.FaultEvent;
			[Bindable]
			private var videoData : ArrayCollection = new ArrayCollection();
			private function handleFault(event : FaultEvent) : void
			{
				trace(event.fault);
			}
			
			private function handleResult(event : ResultEvent) : void
			{
				
				if(event.result.contents.content is ArrayCollection)
				{
					var result : ArrayCollection = event.result.contents.content as ArrayCollection;
					for(var i : int =0; i<result.length; i++)
					{
						var obj : Object = new Object();
						obj.thumbnail = result[i].thumbnail.toString();
						obj.name = result[i].name.toString();
						obj.flv = result[i].flv.toString();
						obj.id = result[i].id.toString();
						videoData.addItem(obj);
					}	
				}else
				{
					
					obj = new Object();
					obj.flv = event.result.contents.content.flv.toString();
					obj.name = event.result.contents.content.name.toString();
					obj.id = event.result.contents.content.id.toString();
					obj.thumbnail = event.result.contents.content.thumbnail.toString();
					videoData.addItem(obj);
					
				}
			}
			
			private function handleApplicationComplete() : void
			{
				var serverUrl:String = Application.application.parameters.serverUrl;
				service.url = serverUrl;
				service.url = "test.xml";
				//navigateToUrl = Application.application.parameters.navigateToUrl;
				service.send();
			}
		]]>
	</mx:Script>
  <local:VideoCoverFlow dataProvider="{videoData}" width="100%" height="100%"/>

</mx:Application>