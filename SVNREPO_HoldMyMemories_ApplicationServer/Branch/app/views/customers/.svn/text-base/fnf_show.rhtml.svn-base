   <%= javascript_include_tag 'prototype' %>
	<%= javascript_include_tag 'check_flash' %>
	<%= javascript_include_tag 'scriptaculous' %>
    <script type="text/javascript">
    function validate() {
      /*
      Following filter taken from
      
      http://www.quirksmode.org/js/mailcheck.html
      
      */
      var filter = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
      var addresses = document.getElementById( "idEmail" ).value.split( "," );
      var ok = true;
      for ( var i=0; i<addresses.length; ++i ) {
        if ( !addresses[i].match(filter) ) {
          ok = false;
          
		  break;
        }
      }
      if ( ok ) {
       // alert( "Input is valid!" );
		return true;
      } else {
        alert( "Input is not valid!" );
		return false;
      }
    }
	
	function check_frn()
	{
		var count = document.getElementById('cnt').value
		
		//alert(document.getElementById('chk[0]').checked);
		var flag=0
		for (i = 0; i < count; i++) 
		{
			if (document.getElementById('chk[' + i + ']').checked == true) {
				flag = 1;
			//return true;
			}
		}	
		if(flag==0)
		{
			alert("Please select atleast one friend before adding to group.")
			return false;
		}
		else
		if(document.getElementById('fnf_category').value=='default'){
			alert("Select Category");
			document.getElementById('fnf_category').focus();
			return false;
		}
		else
		if(document.getElementById('fnf_category').value=='Others' && (document.getElementById('fnf_category_other').value=='' || document.getElementById('fnf_category_other').value=='New Category' ))
		{
			alert("Enter category name");
			document.getElementById('fnf_category_other').focus();
			return false;
		}
		else{
			return true;
		}
		
	
	}	
	
	function Reset() 
	{
		if (document.getElementById('fnf_category_other').value == 'New Category') {
			document.getElementById('fnf_category_other').value = "";
			document.getElementById('fnf_category_other').focus();
		}
	}
	function Reset1() 
	{
		if (document.getElementById('query').value == 'Search friends') {
			document.getElementById('query').value = "";
			document.getElementById('query').focus();
		}
	}
	function Reset2()
	{
		if(document.getElementById('query').value=="")
		document.getElementById('query').value = "Search friends";
	}
	
	//new Form.Element.Observer('query', 2, function(element, value) {Element.show('spinner'); new Ajax.Updater('table', '/customers/fnf_index', {asynchronous:true, evalScripts:true, onSuccess:function(request){Element.hide('spinner')}, parameters:'query=' + value})})
  
  </script>
<%session[:sharepath]='fnf'%>

<% session[:friend]=''%>
<table border="0">
<tr>
  <th width="0" align="left" valign="top" scope="col"></th>
  <th width="510" align="left" valign="top" scope="col">
  	<table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <th width="140" height="22" align="left" valign="top" scope="col">
      	
      	<a href="/customers/edit_profile/<%=logged_in_hmm_user.id%>" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image22','','/images/manage-profile_over.jpg',1)">
      	<img src="/images/manage-profile_def.jpg" name="Image22" width="140" height="22" border="0" id="Image22" /></a>
	  </th>
      
	 
	  <th width="206" align="left" valign="top" scope="col">
	  
	  		<img src="/images/manage-fndsandfmly_over.jpg" name="Image24" width="206" height="22" border="0" id="Image24" /></a>
			</th>
      
	  <th width="164" align="left" valign="top" scope="col">
	  	<a href="/chapter_comment/allcmt_list/" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image25','','/images/manage-comments_over.jpg',1)">
	  	<img src="/images/manage-comments_def.jpg" name="Image25" width="164" height="22" border="0" id="Image25" /></a>	  </th>
		
		<th width="164" align="left" valign="top" scope="col">
	  	<a href="/share_moments/manageShare/" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image26','','/images/manage-share_over.jpg',1)">
	  	<img src="/images/manage-share_def.jpg" name="Image25" width="140" height="22" border="0" id="Image26" /></a>	  
		</th>
		
		<th width="206" align="left" valign="top" scope="col">
	  	<a href="/family_members/edit_fn/<%=logged_in_hmm_user.id%>" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('Image26','','/images/mang_family_web_over.jpg',1)">
	  	<img src="/images/mang_family_web_def.jpg" name="Image25" width="206" height="22" border="0" id="Image26" /></a>	  
		</th>
		
    </tr>
  </table></th>
  <th width="390" align="left" valign="top" scope="col"></th>
</tr>
</table>
<p align="center" width="100%"><font color="f5dfa6"><%= flash[:notice_accept] %></font>
<font color="f5dfa6"><%= flash[:notice_reg]%></font></p>

<table width="100%"><tr>
<td width="886" align="left" valign="top">
	<div id="effect_area">
<table width="100%" border="0" bordercolor="#666666">	
	<tr>
    
    <td width="44%" valign="top">

	

<span>
<% form_remote_tag :update => 'table',
         							:before => "Element.show('spinner1')",
         							:success => "Element.hide('spinner1')",
         							:url => {:action => 'fnf_show'},
		 							:with => 'query' do %>
									
							<img src="/images/circle_load.gif" align="top" border="0" id="spinner" style="display: none;" />
                                                        
					 <input type="text" name="query" onfocusout="Reset2()" onclick="Reset1()" id="query" value="<% if(params[:query]=='' || params[:query]==nil ) %>Search Friends<%else%><%=params[:query]%><%end%>" />
		             <input type='image' align="top" src="/images/search.jpg" name="search" value="search" />
            <%end%>
</span></td>
    <td width="7%" valign="top">&nbsp;&nbsp;</td>	

<td width="20%" align="left" valign="top"></td>
<form name="frm" action="/friends_family/change_group" method="post" onSubmit="return check_frn();">
		
		<td width="14%" valign="top">
 
 				<% @fnf_groups = FnfGroups.find(:all,:conditions => " uid=#{logged_in_hmm_user.id} ") %>
<select name="fnf_category" id="fnf_category" onchange='change_category(this.value)' >
					<option value="default" lable='default'>Add To Group</option>
					<% for i in @fnf_groups %>
						<option value="<%=i.id %>"><%=i.fnf_category %></option>
					<%end%>
					<option value="Others">New category</option>
				</select>			</td>
	  <td width="1%" valign="top">
				<span id='new_ca' style='display:none;'>
		  <input type="text" onClick="Reset(this.value)" size="15" value="New Category" id="fnf_category_other" name="fnf_category_other" /></span></td>
	  <td width="14%" valign="top">
			<input name="sub" type="image" value="Add to Group" src="/images/add-to-group.jpg" align="top"/>			</td>
</tr></table>

<h3><%=@fnf_groupsa.fnf_category%></h3>
 <div id="table">
      	<%= render :partial => "fnf_grouping" %>
      </div>

	
	</div>
        
		
		
		
</td>
<td width="331" valign="top">

<table align="center" width="100%"  border="0" cellspacing="0" cellpadding="0">
    
	
	
      	<font color="f5dfa6"></font>
	
      

	
	<tr bgcolor="#191919" height="20">
      
      <th colspan="2" align="left" valign="middle" scope="col"><font size="2"><font face="Arial, Helvetica, sans-serif">Manage Groups</font></font></th>
    </tr>
	
	
	
    
		
    <tr>
      
      <th width="800" align="left" valign="top" class="text-journal" scope="col">
     <table width="100%" align="center" border="0" >
      	<% for group in @fnf_groups %>
		<tr>
        	<td>
            	
				<% friends = FamilyFriend.count(:all, :conditions => "fnf_category=#{group.id} and status='accepted' and block_status='unblock'")%> 
			<a href="/customers/fnf_show/<%=group.id%>"><%=group.fnf_category%>(<%=friends%>)</a></td>
			<%if group.fnf_category=='Friends' || group.fnf_category=='Family' %>
				<td colspan="2">
				Default Group	<td>
			<%else%>
			<td>
				<%= link_to_remote("Edit",
				:update => 'effect_area', :url => {:controller => :fnf_group, :action => :edit, :id => group.id }) %>			</td>
			<td>
				<a href="/fnf_group/destroying/<%=group.id%>">Delete</a>		</td>
        </tr>
       		<%end%>
		<%end%>   
      </table>            </th>
      <th width="566" align="left" valign="top" scope="col"></th>
    </tr>
    <tr>
      <th align="left" valign="top" class="text-journal" scope="col">&nbsp;</th>
      <th align="left" valign="top" scope="col"></th>
    </tr>
    <tr>
      <th align="left" valign="top" class="text-journal" scope="col">&nbsp;</th>
      <th align="left" valign="top" scope="col"></th>
    </tr>
    
    <tr   align="center" height="20">
      <th colspan="2"  align="left" valign="top" class="text-journal" scope="col"><font size='2'><u><font face='Arial, Helvetica, sans-serif'><u><a href="/customers/list_share/<%=group.id%>">Shared Moments</a></u></font>
		</th>
      </tr>
    <tr>
      <th colspan="2" align="left" valign="top" class="text-journal" scope="col">&nbsp;</th>
    </tr>
    <tr   align="center" height="20">
      <th colspan="2" align="left" valign="top" class="text-journal" scope="col">    	 	
	  <font face='Arial, Helvetica, sans-serif'><u><a href="/customers/list_imports/<%=group.id%>">Imported Moments</a></u></font>
  	</th>
	<tr>
      <th colspan="2" align="left" valign="top" class="text-journal" scope="col">&nbsp;</th>
    </tr>
    </tr>
	<tr   align="center" height="30">
      <th colspan="2" align="left" valign="top" class="text-journal" scope="col">    	 	
	  <font face='Arial, Helvetica, sans-serif'><u><a href="/customers/list_export/<%=group.id%>">Exported Moments</a></u></font>
  	</th>
    </tr>
	<tr>
      <th colspan="2" align="left" valign="top" class="text-journal" scope="col">&nbsp;</th>
    </tr>
    <tr   align="center" height="20">
      <th colspan="2" align="left" valign="top" class="text-journal" scope="col">    	 	
	  <font face='Arial, Helvetica, sans-serif'><u><a href="/customers/shareJournal_list/<%=group.id%>">Shared Journals</a></u></font>
  	</th>
	<tr>
	
	
    <tr>
      <th colspan="2" align="left" valign="top" class="text-journal" scope="col">&nbsp;</th>
    </tr>
    <tr   align="center" height="">
      <th colspan="2" align="left" valign="bottom" class="text-journal" scope="col">    	 	
	  <font face='Arial, Helvetica, sans-serif'><b>Invite friends</b></font>
      <form method="post" action="/invite_friends/create" onSubmit="return validate();">
   

  
  
    <p>
      Please enter one or more email addresses separated by commas.
    </p>
    <input type="text" name="email" id="idEmail"  size=""/>
    <input type="submit" value="add friends" />
  
      </form>
  	</th>
    </tr>
    
    
	<font color="fdf1ca"></font>
	
</table>
	  
	 

</td>
</tr></table>
</form>	

<br>


